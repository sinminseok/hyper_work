# FunnyRun AWS 서비스 가이드 (비개발자용)

## 사용하는 AWS 서비스

### 1. EC2 (서버 컴퓨터)
**쉽게 설명하면?** 클라우드에 있는 컴퓨터

**왜 필요한가요?**
- 앱/웹에서 보내는 요청을 처리하는 프로그램이 돌아가는 곳
- API 서버: 사용자 앱의 요청 처리 (경기 신청, 기록 조회 등)
- Admin 서버: 관리자 페이지 (경기 관리, 사용자 관리 등)

**개선 후 구조**
- API 서버: 2~5대 (사용자 많아지면 자동으로 늘어남)
- Admin 서버: 1대 (관리자만 사용하니까 1대면 충분)

**월 비용**
- API 서버 (t3.small × 평균 3대): 약 $45 (₩60,000)
- Admin 서버 (t3.micro × 1대): 약 $7 (₩9,000)
- **합계: ₩69,000**

---

### 2. RDS (데이터베이스)
**쉽게 설명하면?** 클라우드에 있는 엑셀 같은 데이터 저장소

**왜 필요한가요?**
- 사용자 정보, 경기 정보, 기록 등 모든 데이터를 저장
- MySQL 데이터베이스 사용

**월 비용**
- db.t3.micro × 1대: 약 $15 (₩20,000)

---

### 3. ElastiCache Redis (캐시 저장소)
**쉽게 설명하면?** 빠른 임시 메모장

**왜 필요한가요?**
- 자주 사용하는 데이터를 빠르게 가져오기 위해 임시 저장
- 로그인 세션 정보 저장 (여러 서버에서 공유)
- 실시간 경기 순위 캐싱

**개선 이유**
- 기존: 각 서버마다 Redis가 따로 있어서 데이터 불일치 문제
- 개선: 모든 서버가 하나의 Redis를 공유해서 데이터 일치

**월 비용**
- cache.t3.micro × 1대: 약 $15 (₩20,000)

---

### 4. ALB (로드 밸런서)
**쉽게 설명하면?** 트래픽을 여러 서버로 분산

**왜 필요한가요?**
- 사용자 요청을 여러 API 서버에 골고루 분배
- 한 서버가 고장나도 다른 서버로 자동 전환
- HTTPS 암호화 처리

**경로 분배**
- `/v1/api/*` → API 서버들
- `/admin/*` → Admin 서버

**월 비용**
- 약 $22 (₩29,000)

---

### 5. SNS (알림 발송 서비스)
**쉽게 설명하면?** 우체국 (메시지를 여러 곳에 전달)

**왜 필요한가요?**
- 경기 종료 알림 발송
- 결제 완료 알림 발송
- 여러 시스템에 동시에 메시지 전달

**사용 예시**
- 경기 종료 → SNS로 알림 발송 → 이메일/문자 발송 시스템이 받아서 처리

**월 비용**
- 거의 무료 (월 100만 건까지 무료, 초과분 $0.50/100만 건)
- 예상: $1 미만 (₩1,300)

---

### 6. SQS (메시지 대기열)
**쉽게 설명하면?** 은행 대기표 (순서대로 처리)

**왜 필요한가요?**
- 갑자기 많은 작업이 들어와도 순서대로 안정적으로 처리
- 결제 처리, 경기 결과 계산 등 중요한 작업을 놓치지 않음

**사용 예시**
- 100명의 경기가 동시에 끝남 → SQS에 100개 메시지 저장 → 하나씩 처리

**월 비용**
- 거의 무료 (월 100만 건까지 무료)
- 예상: $1 미만 (₩1,300)

---

### 7. S3 (파일 저장소)
**쉽게 설명하면?** 클라우드 하드디스크

**왜 필요한가요?**
- 배포용 파일 저장
- 앱 업데이트 파일 보관

**월 비용**
- 스토리지: 약 $0.50 (₩650)

---

### 8. Route53 (DNS)
**쉽게 설명하면?** 주소록 (도메인 → IP 연결)

**왜 필요한가요?**
- `funnyrun.com` 주소를 실제 서버 주소로 연결
- 사용자가 쉬운 도메인으로 접속 가능

**월 비용**
- 호스팅 영역: $0.50 (₩650)

---

### 9. CodeDeploy (자동 배포)
**쉽게 설명하면?** 자동 설치 로봇

**왜 필요한가요?**
- 개발자가 코드를 푸시하면 자동으로 서버에 배포
- 사람이 직접 배포할 때보다 실수 적음

**월 비용**
- 무료

---

### 10. VPC, Subnet, NAT 등 (네트워크)
**쉽게 설명하면?** 회사 건물과 보안 시스템

**왜 필요한가요?**
- 서버를 외부 공격으로부터 보호
- 서버끼리 안전하게 통신

**월 비용**
- NAT Instance (t3.micro): 약 $7 (₩9,000)

---

## 💰 총 비용 정리 (월)

| 서비스 | 설명 | 월 비용 (원) |
|--------|------|-------------|
| **EC2 (API 서버)** | 사용자 요청 처리 | ₩60,000 |
| **EC2 (Admin 서버)** | 관리자 페이지 | ₩9,000 |
| **RDS** | 데이터베이스 | ₩20,000 |
| **ElastiCache Redis** | 캐시 | ₩20,000 |
| **ALB** | 로드 밸런서 | ₩29,000 |
| **SNS** | 알림 발송 | ₩1,000 |
| **SQS** | 메시지 대기열 | ₩1,000 |
| **S3** | 파일 저장 | ₩1,000 |
| **Route53** | DNS | ₩1,000 |
| **NAT Instance** | 네트워크 보안 | ₩9,000 |
| **CodeDeploy** | 자동 배포 | 무료 |
| **합계** | - | **₩151,000** |

**참고**
- 환율: $1 = ₩1,300 기준
- 사용자 증가 시 API 서버가 자동으로 늘어나면 비용 추가 (서버 1대당 ₩20,000)
- 트래픽이 많아지면 데이터 전송 비용 추가 가능

---

## 📊 비용 절감 포인트

### 1. 예약 인스턴스 (Reserved Instance)
- 1년 약정 시 40% 할인
- 3년 약정 시 60% 할인
- **예상 절감액**: 월 ₩40,000 ~ ₩60,000

### 2. Savings Plans
- 유연한 할인 옵션 (인스턴스 타입 변경 가능)
- 1년 약정 시 30% 할인
- **예상 절감액**: 월 ₩30,000 ~ ₩45,000

### 3. 트래픽이 적은 시간대 서버 축소
- 새벽 시간대 API 서버 2대로 축소
- **예상 절감액**: 월 ₩10,000 ~ ₩15,000

---

## 🔄 개선 전 vs 개선 후

### 개선 전 (현재)
```
EC2 1대 안에 모든 것이 함께 있음
┌─────────────────────┐
│  EC2 (1대)          │
│  ├── API 서버       │
│  ├── Admin 서버     │
│  └── Redis          │
└─────────────────────┘

문제점:
- API 부하 증가 시 Admin, Redis도 같이 복제됨
- Redis가 여러 개 생기면 데이터 꼬임
- 비효율적
```

### 개선 후
```
각 서비스가 독립적으로 확장
┌─────────────────────┐   ┌─────────────────────┐   ┌─────────────────────┐
│  EC2 (API #1)       │   │  EC2 (API #2)       │   │  EC2 (Admin)        │
│  └── API 서버       │   │  └── API 서버       │   │  └── Admin 서버     │
└─────────┬───────────┘   └─────────┬───────────┘   └─────────────────────┘
          │                         │
          └─────────┬───────────────┘
                    ▼
          ┌─────────────────────┐
          │  ElastiCache Redis  │
          │  (공유)             │
          └─────────────────────┘

장점:
- API만 독립적으로 확장 가능
- Redis는 하나만 사용 (데이터 일관성)
- 비용 효율적
```

---

## ❓ 자주 묻는 질문

### Q1. 왜 서버를 여러 대 사용하나요?
A: 사용자가 많아지면 1대로는 처리가 느려집니다. 여러 대가 나눠서 처리하면 빠릅니다.

### Q2. Auto Scaling이 뭔가요?
A: 사용자가 많을 때 자동으로 서버를 늘리고, 적을 때 줄이는 기능입니다. 비용 절감 + 안정성 향상

### Q3. Redis는 왜 필요한가요?
A: 데이터베이스는 느립니다. 자주 쓰는 데이터는 Redis에 임시 저장해서 빠르게 가져옵니다.

### Q4. SNS/SQS는 왜 둘 다 필요한가요?
A: SNS는 "여러 곳에 동시 전달", SQS는 "순서대로 안전하게 처리"입니다. 목적이 다릅니다.

### Q5. 이 구조면 몇 명까지 사용 가능한가요?
A: 현재 구조로 동시 접속자 약 1,000~2,000명 처리 가능합니다. 더 늘어나면 서버만 추가하면 됩니다.
